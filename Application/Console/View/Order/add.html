<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>无标题文档</title>
        <link href="__PUBLIC__/Console/css/style.css" rel="stylesheet" type="text/css" />
        <link href="__PUBLIC__/Console/css/select.css" rel="stylesheet" type="text/css" />
        <link href="__PUBLIC__/Console/css/lanrenzhijia.css" rel="stylesheet" type="text/css" />
        <script src="__PUBLIC__/Console/js/jquery.1.4.2-min.js"></script>
        <script src="__PUBLIC__/Console/js/Calculation.js"></script>

        <script src="__PUBLIC__/Console/js/validation/lib/jquery.js"></script>
        <script src="__PUBLIC__/Console/js/validation/dist/jquery.validate.js"></script>
        <script src="__PUBLIC__/Console/js/validation/dist/localization/messages_zh.js"></script> 
        <script>
            $(function () {
                $.validator.setDefaults({
                    submitHandler: function () {
                        $("#form1").submit();
                    }
                });

                $("#form1").validate({
                    rules: {
                        agent: 'required',
                        assistant: 'required',
                        equipment: 'required',
                        Payment_method: 'required',
                        buyer_wechat: {
                            required: true,
                            minlength: 2
                        },
                        source: {
                            required: true,
                            minlength: 2
                        },
                        username: {
                            required: true,
                            minlength: 2
                        },
                        mobile: {
                            required: true,
                            number: true,
                            minlength: 11,
                            maxlength: 11
                        },
                        address: {
                            required: true,
                            minlength: 10
                        }

                    },
                    messages: {
                        agent: "请选择经纪人",
                        assistant: "请选择经纪助理编号",
                        equipment: "请选择设备编号",
                        Payment_method: "请选择支付方式",
                        buyer_wechat: {
                            required: "请输入买家微信号",
                            minlength: "不能少于2个字符",
                        },
                        source: {
                            required: "请输入订单来源",
                            minlength: "不能少于2个字符",
                        },
                        username: {
                            required: "请输入收件人姓名",
                            minlength: "不能少于2个字符",
                        },
                        mobile: {
                            required: "请输入收件人电话",
                            minlength: "11位手机号",
                            maxlength: "11位手机号",
                            number: "电话格式错误"
                        },
                        address: {
                            required: "请输入收件人地址",
                            minlength: "不能少于10个字符",
                        }
                    },
                    errorClass: 'cerror',
                });
            });
        </script>
    </head>
    <body>

        <div class="place">
            <span>位置：</span>
            <ul class="placeul">

                <li><a href="#">首页</a></li>
                <li><a href="#">订单管理</a></li>
                <li><a href="#">添加订单</a></li>
            </ul>
        </div>

        <div class="formbody">
            <div id="usual1" class="usual"> 
                <form name="form1" id="form1" method='post' action="__URL__/insert" >
                    <div class="itab">      
                        <!--<form name="form1" id="form1" method='post' action="__URL__/insert" onsubmit="if(!checkdata()){return false;}">-->
                        <ul> 
                            <li><a href="#tab1" class="selected">添加订单</a></li> 
                            <input type="hidden" name="order_no"  value="2016051599535210">
                        </ul>
                    </div> 

                    <div id="tab1" class="tabson">

                        <div class="formtext">请正确填写订单信息！</div>
                        <ul class="forminfo">
                            <li><label>经纪人组长<b>*</b></label>  
                                <div class="vocation uew-select">
                                    <select id="assistant" name="assistant" class="uew-select-value">
                                        <volist name="assistant" id="vo1">
                                            <option value="{$vo1.id}">{$vo1.username}</option>
                                        </volist>
                                    </select>
                                </div>
                            </li>

                            <li><label>经纪人<b>*</b></label>  
                                <div class="vocation uew-select">
                                    <select id="agent" name="agent" class="uew-select-value">                                      
                                            <option value="0">没有参数</option>
                                    </select>
                                </div>
                            </li>
                            <li><label>设备编号<b>*</b></label>  
                                <div class="vocation uew-select">
                                    <select name="equipment" class="uew-select-value">
                                        <volist name="equipment" id="vo3">
                                            <option value="{$vo3.id}">{$vo3.xinghao}({$vo3.bianhao})</option>
                                        </volist>
                                    </select>
                                </div>
                            </li>

                            <li><label>支付方式<b>*</b></label>  
                                <div class="vocation uew-select">
                                    <select name="Payment_method" class="uew-select-value">
                                        <volist name="payment" id="vo4">
                                            <option value="{$vo4.id}">{$vo4.payment}</option>
                                        </volist>
                                    </select>
                                </div>
                            </li>

                            <li>
                                <label>买家微信号<b>*</b></label>
                                <input id="buyer_wechat" name="buyer_wechat" type="text" class="dfinput" value=""  />
                            </li>
                            <li><label>订单来源<b>*</b></label><input id="source" name="source" type="text" class="dfinput" value="" /></li>
                            <li><label>收件人姓名<b>*</b></label><input id="username" name="username" type="text" class="dfinput" value=""  /></li>
                            <li><label>收件人电话<b>*</b></label><input id="mobile" name="mobile" type="text" class="dfinput" value="" /></li>
                            <li><label>收件人地址<b>*</b></label><input id="address" name="address" type="text" class="dfinput" value=""  /></li>
                            <li><label>订单备注<b></b></label><input name="note" type="text" class="dfinput" value=""  /></li>
                            <li><label><b>购买商品</b></li>
                        </ul>

                        <include file="./Application/Console/View/order/shopping.html" />


                        <li><label>&nbsp;</label><input name="" type="submit" class="btn" value="提交订单"/></li>



                    </div> 
                </form>        
            </div> 
        </div>

        </div>
        <script>
            jingjiren($("#assistant").val());
            $(function(){
                $("#assistant").change(function(){

                    jingjiren($(this).val());      
                });
            })
            function jingjiren(id){            
                var url="{:U('Order/getagent')}"+"?id="+id;
                $.get(url,function(data){
                    $("#agent").html("");                    
                    var option="";           
                    if(data!="0" && data!="null" ){                       
                        for( i in data){                         
                            option+="<option value=1"+i+"1>"+data[i]+"</option>"
                        }                       
                        $("#agent").html(option);                       
                    }else{
                        option="<option value=0>请选择</option>"
                        $("#agent").html(option);
                    }   
                })
            }
        </script>
    </body>

</html>
